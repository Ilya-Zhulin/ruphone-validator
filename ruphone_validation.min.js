/* Created by Ilya A.Zhulin <ilya.zhulin@hotmail.com> 2020 */
function addSybmol(c,d,e){c.length>d&&c[d]!=e&&c.splice(d,0,e);return c}var a,b;document.querySelector("input[type='tel']").onselect=function(){a=document.querySelector("input[type='tel']").selectionStart;b=document.querySelector("input[type='tel']").selectionEnd};
jQuery("input[type='tel']").on("input",function(c,d){$this=jQuery(this);allows="1234567890".split("");key=c.originalEvent.data;$caret=c.target.selectionStart;$val=$this.val();rep="";a&&b&&(rep=0<b-a?Array(b-a).join("_"):"");"deleteContentBackward"==c.originalEvent.inputType?($val=$val.substr(0,$caret)+"_"+rep+$val.substr($caret),c.preventDefault()):-1<$val.indexOf("_")&&($val=$val.substr(0,$caret)+$val.substr($caret).replace("_",""));val=$val.replace(/\s/g,"").replace("+","").replace("(","").replace(")",
"").replace(/\-/g,"");val=11<=val.length?val=val.substr(0,11):val;-1==jQuery.inArray(key,allows)&&(c.preventDefault(),val=val.replace(key,""));ar=val.split("");if(0==ar.join("").replace(/_/g,"").length||"+"==ar.join("").replace(/_/g,""))ar=[];0<ar.length&&(8!=ar[0]&&7!=ar[0]&&"+"!=ar[0]&&(tmp=ar[0],ar[0]="7",ar[1]=tmp,$caret=5),ar=addSybmol(ar,1," "),ar=addSybmol(ar,2,"("),ar=addSybmol(ar,6,")"),ar=addSybmol(ar,7," "),ar=addSybmol(ar,11,"-"),ar=addSybmol(ar,14,"-"));c.preventDefault();$new_val="7"==
ar[0]||0===ar.length?"+"+ar.join(""):ar.join("");"+"==$new_val&&"+"!=key&&($new_val="");$this.val($new_val);$new_caret="deleteContentBackward"==c.originalEvent.inputType?8==ar[0]?2==$caret?1:7==$caret?6:12==$caret?11:15==$caret?14:$caret:3==$caret?2:8==$caret?7:13==$caret?12:16==$caret?15:1==$caret?3:$caret:8==ar[0]?2==$caret?4:7==$caret?9:12==$caret?13:15==$caret?16:$caret:3==$caret?5:8==$caret?"10":13==$caret?14:"16"==$caret?17:$caret;document.querySelector("input[type='tel']").setSelectionRange($new_caret,
$new_caret)});