/*
		Copyright (C) 2020 - 2022 Ilya A.Zhulin. All Rights Reserved.

*/
'use strict';document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll("input[type='tel'], input[data-type='tel']").forEach(h=>{h.addEventListener("input",function(m){let p="1234567890+*!".split(""),q="force"===h.getAttribute("data-rutel")?1:0,e=m.target.selectionStart,d=0,k=0,g=h.value,c=[],a=0,n,r="__ (___) ___-__-__".split(""),t="__ (____) __-__-__".split(""),u="_ (___) ___-__-__".split(""),v="_ (____) __-__-__".split(""),b=[];d=e;g="deleteContentBackward"===m.inputType?g.slice(0,
e)+"*"+g.slice(e):g.slice(0,e)+"!"+g.slice(e);c=g.split("");c.forEach((f,l)=>{if(-1===p.indexOf(f)||0<l&&"+"==f)c[l]="",d=e>=l?e-1:e});"8"==c[0]?0===q?b=c[3]&&"9"==c[3]?u:v:(c.shift(),c.unshift("+","7")):b=c[4]&&"9"==c[4]?r:t;n=b.length;c.forEach((f,l)=>{if(a<n&&""!=f){for(;"_"!=b[a];)if(a++,0<k||d===a)d++,k++;if("*"==f){if("-"==b[a]||" "==b[a]||")"==b[a]||"("==b[a])for(;"-"==b[a]||" "==b[a]||")"==b[a]||"("==b[a];)console.log("\u0417\u043d\u0430\u043a: "+b[a]),d=a-1;else b[a]="_",0<k&&(d=a-1);a++}else"!"==
f?d=a:(b[a]=f,a++);k=0}});h.value=b.join("");h.setSelectionRange(d,d)})})});
