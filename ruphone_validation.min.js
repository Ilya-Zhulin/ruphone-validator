/*
		Copyright (C) 2020 - 2022 Ilya A.Zhulin. All Rights Reserved.

*/
'use strict';function _telValidate(g){g.addEventListener("input",function(n){let f="1234567890+*!".split(""),t="force"===g.getAttribute("data-rutel")?1:0,k=n.target.selectionStart,h=0,p=0,m=g.value,a=[],b=0,r,d="__ (___) ___-__-__".split(""),e="__ (____) __-__-__".split(""),u="_ (___) ___-__-__".split(""),v="_ (____) __-__-__".split(""),c=[];h=k;m="deleteContentBackward"===n.inputType?m.slice(0,k)+"*"+m.slice(k):m.slice(0,k)+"!"+m.slice(k);a=m.split("");a.forEach((l,q)=>{if(-1===f.indexOf(l)||0<q&&
"+"==l)a[q]="",h=k>=q?k-1:k});"8"==a[0]?0===t?c=a[3]&&"9"==a[3]?u:v:(a.shift(),a.unshift("+","7"),c=d):"+"==a[0]?("7"==a[1]?c=d:(a.shift(),a.unshift("+","7")),c=""==a[2]?""==a[3]?"9"==a[4]?d:e:"9"==a[3]?d:e:""==a[2]?"9"==a[3]?d:e:"9"==a[2]?d:e):7==a[0]?(a.unshift("+"),c=""==a[2]?"("==a[3]?"9"==a[4]?d:e:"9"==a[3]?d:e:"("==a[2]?"9"==a[3]?d:e:"9"==a[2]?d:e):"*"!=a[0]&&(a.unshift("+","7"),c=""==a[2]?"("==a[3]?"9"==a[4]?d:e:"9"==a[3]?d:e:"("==a[2]?"9"==a[3]?d:e:"9"==a[2]?d:e);r=c.length;a.forEach((l,q)=>
{if(b<r&&""!=l){for(;"_"!=c[b];)if(b++,0<p||h===b)h++,p++;if("*"==l){if("-"==c[b]||" "==c[b]||")"==c[b]||"("==c[b])for(;"-"==c[b]||" "==c[b]||")"==c[b]||"("==c[b];)h=b-1;else c[b]="_",0<p&&(h=b-1);b++}else"!"==l?h=b:(c[b]=l,b++);p=0}});g.value=c.join("");g.setSelectionRange(h,h)})}
document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll("input[type='tel'], input[data-type='tel']").forEach(g=>{_telValidate(g)});(new MutationObserver(g=>{for(let n of g)for(let f of n.addedNodes)f instanceof HTMLElement&&((f.matches("[type='tel']")||f.matches("[data-type='tel']"))&&_telValidate(f),f.querySelector("[data-type='tel']")&&_telValidate(f.querySelector("[data-type='tel']")),f.querySelector("[type='tel']")&&_telValidate(f.querySelector("[type='tel']")))})).observe(document.documentElement,
{childList:!0,subtree:!0})});
